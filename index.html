<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Wallace个人博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Wallace的个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="Wallace个人博客">
<meta property="og:url" content="https://wjwite.github.io/index.html">
<meta property="og:site_name" content="Wallace个人博客">
<meta property="og:description" content="Wallace的个人博客">
<meta property="og:locale" content="zh-cn">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wallace个人博客">
<meta name="twitter:description" content="Wallace的个人博客">
  
    <link rel="alternate" href="/atom.xml" title="Wallace个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Wallace个人博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">博客</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://wjwite.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Flutter新屏幕" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/28/Flutter新屏幕/Flutter/" class="article-date">
  <time datetime="2018-06-28T09:36:56.000Z" itemprop="datePublished">2018-06-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Flutter/">Flutter</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/28/Flutter新屏幕/Flutter/">Flutter新屏幕</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>大多数应用程序包含几个用于显示不同类型信息的屏幕 例如，我们可能有一个显示产品的屏幕。然后，我们的用户可以在新屏幕上点击产品以获取更多信息。<br>在Android中是新的activity。 在iOS里面是新的ViewControllers。而在Flutter中，屏幕只是一个小工具！<br>那么要怎么去新的的屏幕呢? 使用Navigator!</p>
<h2 id="路线"><a href="#路线" class="headerlink" title="路线"></a>路线</h2><ol>
<li>创建两个屏幕</li>
<li>使用导航到第二个屏幕 Navigator.push</li>
<li>使用返回到第一个屏幕 Navigator.pop<h3 id="1-创建两个屏幕"><a href="#1-创建两个屏幕" class="headerlink" title="1.创建两个屏幕"></a>1.创建两个屏幕</h3>首先，我们需要两个屏幕来处理。由于这是一个基本的例子，我们将创建两个屏幕，每个屏幕都包含一个按钮。点击第一个屏幕上的按钮将导航到第二个屏幕。点击第二个屏幕上的按钮将使我们的用户回到第一个！</li>
</ol>
<p>首先，我们将设置视觉结构。<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FirstScreen</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">'First Screen'</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: RaisedButton(</span><br><span class="line">          child: Text(<span class="string">'Launch screen'</span>),</span><br><span class="line">          onPressed: () &#123;</span><br><span class="line">            <span class="comment">// Navigate to second screen when tapped!</span></span><br><span class="line">          &#125;,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SecondScreen</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">"Second Screen"</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: RaisedButton(</span><br><span class="line">          onPressed: () &#123;</span><br><span class="line">            <span class="comment">// Navigate back to first screen when tapped!</span></span><br><span class="line">          &#125;,</span><br><span class="line">          child: Text(<span class="string">'Go back!'</span>),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="2-使用导航到第二个屏幕-Navigator-push"><a href="#2-使用导航到第二个屏幕-Navigator-push" class="headerlink" title="2.使用导航到第二个屏幕 Navigator.push"></a>2.使用导航到第二个屏幕 Navigator.push</h3><p>为了导航到新的屏幕，我们需要使用该Navigator.push方法。该push方法将添加Route到由导航器管理的路线堆栈中！</p>
<p>该push方法需要一个Route，但Route从哪里来？我们可以创建自己的，或使用MaterialPageRoute开箱即用。这MaterialPageRoute很方便，因为它使用平台特定的动画转换到新屏幕。</p>
<p>在build我们的FirstScreenWidget 的方法中，我们将更新onPressed 回调：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Within the `FirstScreen` Widget</span></span><br><span class="line">onPressed: () &#123;</span><br><span class="line">  Navigator.push(</span><br><span class="line">    context,</span><br><span class="line">    MaterialPageRoute(builder: (context) =&gt; SecondScreen()),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-使用返回到第一个屏幕-Navigator-pop"><a href="#3-使用返回到第一个屏幕-Navigator-pop" class="headerlink" title="3.使用返回到第一个屏幕 Navigator.pop"></a>3.使用返回到第一个屏幕 Navigator.pop</h3><p>现在我们在第二个屏幕上，我们如何关闭它并返回到第一个屏幕？使用该Navigator.pop方法！该pop方法将从Route导航器管理的路线堆栈中移除当前路径。</p>
<p>对于这部分，我们需要更新onPressed我们的SecondScreenWidget中的回调</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Within the SecondScreen Widget</span></span><br><span class="line">onPressed: () &#123;</span><br><span class="line">  Navigator.pop(context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通常，我们不仅要导航到新的屏幕，还要将一些数据传递到屏幕。例如，我们经常想传递关于我们点击的项目的信息。</p>
<p>请记住：屏幕只是Widgets™。在这个例子中，我们将创建一个Todos列表。当点击一个待办事项时，我们将导航到一个显示关于待办事项信息的新屏幕（Widget）。</p>
<h3 id="4-定义一个Todo类"><a href="#4-定义一个Todo类" class="headerlink" title="4.定义一个Todo类"></a>4.定义一个Todo类</h3><p>创建一个数据类</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> title;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> description;</span><br><span class="line"></span><br><span class="line">  Todo(<span class="keyword">this</span>.title, <span class="keyword">this</span>.description);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-创建一个Todos列表"><a href="#5-创建一个Todos列表" class="headerlink" title="5.创建一个Todos列表"></a>5.创建一个Todos列表</h3><p>其次，我们要显示一个Todos列表。在这个例子中，我们将生成20个待办事项并使用ListView显示它们。</p>
<h5 id="生成Todos列表"><a href="#生成Todos列表" class="headerlink" title="生成Todos列表"></a>生成Todos列表</h5><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> todos = <span class="built_in">List</span>&lt;Todo&gt;.generate(</span><br><span class="line">  <span class="number">20</span>,</span><br><span class="line">  (i) =&gt; Todo(</span><br><span class="line">        <span class="string">'Todo $i'</span>,</span><br><span class="line">        <span class="string">'A description of what needs to be done for Todo $i'</span>,</span><br><span class="line">      ),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h5 id="使用ListView显示Todos列表"><a href="#使用ListView显示Todos列表" class="headerlink" title="使用ListView显示Todos列表"></a>使用ListView显示Todos列表</h5><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ListView.builder(</span><br><span class="line">  itemCount: todos.length,</span><br><span class="line">  itemBuilder: (context, index) &#123;</span><br><span class="line">    <span class="keyword">return</span> ListTile(</span><br><span class="line">      title: Text(todos[index].title),</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="6-创建一个详细信息屏幕，可以显示有关待办事项的信息"><a href="#6-创建一个详细信息屏幕，可以显示有关待办事项的信息" class="headerlink" title="6.创建一个详细信息屏幕，可以显示有关待办事项的信息"></a>6.创建一个详细信息屏幕，可以显示有关待办事项的信息</h3><p>现在，我们将创建我们的第二个屏幕。屏幕的标题将包含待办事项的标题，屏幕正文将显示说明。</p>
<p>由于这是正常的StatelessWidget，我们只需要创建屏幕的用户通过Todo！然后，我们将使用给定的Todo来构建UI。<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DetailScreen</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Declare a field that holds the Todo</span></span><br><span class="line">  <span class="keyword">final</span> Todo todo;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// In the constructor, require a Todo</span></span><br><span class="line">  DetailScreen(&#123;Key key, <span class="meta">@required</span> <span class="keyword">this</span>.todo&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">// Use the Todo to create our UI</span></span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">"<span class="subst">$&#123;todo.title&#125;</span>"</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Padding(</span><br><span class="line">        padding: EdgeInsets.all(<span class="number">16.0</span>),</span><br><span class="line">        child: Text(<span class="string">'<span class="subst">$&#123;todo.description&#125;</span>'</span>),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="7-导航并将数据传递到详细信息屏幕"><a href="#7-导航并将数据传递到详细信息屏幕" class="headerlink" title="7.导航并将数据传递到详细信息屏幕"></a>7.导航并将数据传递到详细信息屏幕</h3><p>随着我们DetailScreen的到位，我们准备好进行导航！在我们的例子中，我们将要导航到DetailScreen用户点击我们列表中的待办事项。当我们这样做时，我们也想把Todo传递给DetailScreen。</p>
<p>为了实现这一点，我们将为onTap 我们的ListTileWidget 写回调。在我们的onTap回调中，我们将再次采用该Navigator.push方法。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ListView.builder(</span><br><span class="line">  itemCount: todos.length,</span><br><span class="line">  itemBuilder: (context, index) &#123;</span><br><span class="line">    <span class="keyword">return</span> ListTile(</span><br><span class="line">      title: Text(todos[index].title),</span><br><span class="line">      <span class="comment">// When a user taps on the ListTile, navigate to the DetailScreen.</span></span><br><span class="line">      <span class="comment">// Notice that we're not only creating a DetailScreen, we're</span></span><br><span class="line">      <span class="comment">// also passing the current todo to it!</span></span><br><span class="line">      onTap: () &#123;</span><br><span class="line">        Navigator.push(</span><br><span class="line">          context,</span><br><span class="line">          MaterialPageRoute(</span><br><span class="line">            builder: (context) =&gt; DetailScreen(todo: todos[index]),</span><br><span class="line">          ),</span><br><span class="line">        );</span><br><span class="line">      &#125;,</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>在某些情况下，我们可能想要从新屏幕返回数据。例如，假设我们推送一个新屏幕，向用户呈现两个选项。当用户点击某个选项时，我们需要通知用户选择的第一个屏幕，以便它能够处理这些信息！</p>
<h3 id="8-定义主屏幕"><a href="#8-定义主屏幕" class="headerlink" title="8.定义主屏幕"></a>8.定义主屏幕</h3><p>主屏幕将显示一个按钮。点击后，它将启动选择屏幕！</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomeScreen</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">'Returning Data Demo'</span>),</span><br><span class="line">      ),</span><br><span class="line">      <span class="comment">// We'll create the SelectionButton Widget in the next step </span></span><br><span class="line">      body: Center(child: SelectionButton()),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="9-添加一个启动选择屏幕的按钮"><a href="#9-添加一个启动选择屏幕的按钮" class="headerlink" title="9.添加一个启动选择屏幕的按钮"></a>9.添加一个启动选择屏幕的按钮</h3><p>现在，我们将创建我们的SelectionButton。我们的选择按钮将会：</p>
<ol>
<li>点击时启动SelectionScreen</li>
<li>等待SelectionScreen返回结果</li>
</ol>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SelectionButton</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> RaisedButton(</span><br><span class="line">      onPressed: () &#123;</span><br><span class="line">        _navigateAndDisplaySelection(context);</span><br><span class="line">      &#125;,</span><br><span class="line">      child: Text(<span class="string">'Pick an option, any option!'</span>),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// A method that launches the SelectionScreen and awaits the result from</span></span><br><span class="line">  <span class="comment">// Navigator.pop</span></span><br><span class="line">  _navigateAndDisplaySelection(BuildContext context) <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="comment">// Navigator.push returns a Future that will complete after we call</span></span><br><span class="line">    <span class="comment">// Navigator.pop on the Selection Screen!</span></span><br><span class="line">    <span class="keyword">final</span> result = <span class="keyword">await</span> Navigator.push(</span><br><span class="line">      context,</span><br><span class="line">      <span class="comment">// We'll create the SelectionScreen in the next step!</span></span><br><span class="line">      MaterialPageRoute(builder: (context) =&gt; SelectionScreen()),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="10-用两个按钮显示选择屏幕"><a href="#10-用两个按钮显示选择屏幕" class="headerlink" title="10.用两个按钮显示选择屏幕"></a>10.用两个按钮显示选择屏幕</h3><p>现在，我们需要构建一个选择屏幕！它将包含两个按钮。当用户点击按钮时，它应该关闭选择屏幕并让主屏幕知道哪个按钮被点击！</p>
<p>现在，我们将定义UI，并确定如何在下一步中返回数据。<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SelectionScreen</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">'Pick an option'</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: Column(</span><br><span class="line">          mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Padding(</span><br><span class="line">              padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">8.0</span>),</span><br><span class="line">              child: RaisedButton(</span><br><span class="line">                onPressed: () &#123;</span><br><span class="line">                  <span class="comment">// Pop here with "Yep"...</span></span><br><span class="line">                &#125;,</span><br><span class="line">                child: Text(<span class="string">'Yep!'</span>),</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">            Padding(</span><br><span class="line">              padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">8.0</span>),</span><br><span class="line">              child: RaisedButton(</span><br><span class="line">                onPressed: () &#123;</span><br><span class="line">                  <span class="comment">// Pop here with "Nope"</span></span><br><span class="line">                &#125;,</span><br><span class="line">                child: Text(<span class="string">'Nope.'</span>),</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>###11.轻按按钮时，关闭选择画面<br>现在，我们要更新onPressed我们两个按钮的回调！为了将数据返回到第一个屏幕，我们需要使用该Navitator.pop方法。</p>
<p>Navigator.pop接受一个可选的第二个参数result。如果我们提供结果，它将返回到Future我们的SelectionButton中！</p>
<h5 id="Yep按钮"><a href="#Yep按钮" class="headerlink" title="Yep按钮"></a>Yep按钮</h5><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RaisedButton(</span><br><span class="line">  onPressed: () &#123;</span><br><span class="line">    <span class="comment">// Our Yep button will return "Yep!" as the result</span></span><br><span class="line">    Navigator.pop(context, <span class="string">'Yep!'</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  child: Text(<span class="string">'Yep!'</span>),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h5 id="Nope按钮"><a href="#Nope按钮" class="headerlink" title="Nope按钮"></a>Nope按钮</h5><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RaisedButton(</span><br><span class="line">  onPressed: () &#123;</span><br><span class="line">    <span class="comment">// Our Nope button will return "Nope!" as the result</span></span><br><span class="line">    Navigator.pop(context, <span class="string">'Nope!'</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  child: Text(<span class="string">'Nope!'</span>),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>###12.在选择的主屏幕上显示SnackBar<br>既然我们正在启动一个选择屏幕并等待结果，那么我们会想要对返回的信息进行一些操作！</p>
<p>在这种情况下，我们将显示一个显示结果的Snackbar。为此，我们将更新我们的_navigateAndDisplaySelection方法SelectionButton。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">_navigateAndDisplaySelection(BuildContext context) <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="keyword">final</span> result = <span class="keyword">await</span> Navigator.push(</span><br><span class="line">    context,</span><br><span class="line">    MaterialPageRoute(builder: (context) =&gt; SelectionScreen()),</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// After the Selection Screen returns a result, show it in a Snackbar!</span></span><br><span class="line">  Scaffold.of(context).showSnackBar(SnackBar(content: Text(<span class="string">"$result"</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://wjwite.github.io/2018/06/28/Flutter新屏幕/Flutter/" data-id="cjizlkeqm00083vj5rvkq7nky" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flutter获取互联网数据" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/28/Flutter获取互联网数据/Flutter/" class="article-date">
  <time datetime="2018-06-28T08:57:43.000Z" itemprop="datePublished">2018-06-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Flutter/">Flutter</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/28/Flutter获取互联网数据/Flutter/">Flutter 获取互联网数据</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="获取网上数据"><a href="#获取网上数据" class="headerlink" title="获取网上数据"></a>获取网上数据</h2><h3 id="添加http包"><a href="#添加http包" class="headerlink" title="添加http包"></a>添加http包</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dependencies:</span><br><span class="line">  http: <span class="string">"^0.11.3+16"</span></span><br></pre></td></tr></table></figure>
<p>这个http包提供了最简单的获取网上数据的方法。<br>要安装这个http包，我们需要将它添加到我们的依赖项部分pubspec.yaml。<br>我们可以在pub网站上找到最新版本的<a href="https://pub.dartlang.org/packages/http#-installing-tab-" target="_blank" rel="noopener">http软件包</a>。</p>
<h3 id="发出网络请求"><a href="#发出网络请求" class="headerlink" title="发出网络请求"></a>发出网络请求</h3><p>示例<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;http.Response&gt; fetchPost() &#123;</span><br><span class="line">  <span class="keyword">return</span> http.<span class="keyword">get</span>(<span class="string">'https://jsonplaceholder.typicode.com/posts/1'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>该http.get方法返回数据。</p>
<ul>
<li>Future是与异步操作一起工作的核心Dart类。它用于表示未来某个时间可能会出现的潜在价值或错误。</li>
<li>本http.Response类包含一个成功的HTTP调用接收到的数据。</li>
</ul>
<h3 id="将响应转换为自定义Dart对象"><a href="#将响应转换为自定义Dart对象" class="headerlink" title="将响应转换为自定义Dart对象"></a>将响应转换为自定义Dart对象</h3><p>虽然提出网络请求很容易，但使用原始Future&lt;http.Response&gt;数据并不方便。为了让我们的生活更轻松，我们可以将它转换http.Response成我们自己的Dart对象。</p>
<h5 id="创建一个Post类"><a href="#创建一个Post类" class="headerlink" title="创建一个Post类"></a>创建一个Post类</h5><p>首先，我们需要创建一个Post包含我们网络请求数据的类。它还将包括一个工厂构造函数，它允许我们Post从json 创建一个。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> userId;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> id;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> title;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> body;</span><br><span class="line"></span><br><span class="line">  Post(&#123;<span class="keyword">this</span>.userId, <span class="keyword">this</span>.id, <span class="keyword">this</span>.title, <span class="keyword">this</span>.body&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">factory</span> Post.fromJson(<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="keyword">dynamic</span>&gt; json) &#123;</span><br><span class="line">    <span class="keyword">return</span> Post(</span><br><span class="line">      userId: json[<span class="string">'userId'</span>],</span><br><span class="line">      id: json[<span class="string">'id'</span>],</span><br><span class="line">      title: json[<span class="string">'title'</span>],</span><br><span class="line">      body: json[<span class="string">'body'</span>],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="转换http-Response为Post"><a href="#转换http-Response为Post" class="headerlink" title="转换http.Response为Post"></a>转换http.Response为Post</h5><p>现在，我们将更新fetchPost函数以返回一个Future<post>。为此，我们需要：</post></p>
<ol>
<li>Map使用该dart:convert 包将响应正文转换为json 。</li>
<li>如果服务器返回状态码为200的“OK”响应，请将json Map转换为Post使用fromJson工厂。</li>
<li>如果服务器返回意外的响应，则会发出错误。</li>
</ol>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;Post&gt; fetchPost() <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="keyword">final</span> response =</span><br><span class="line">      <span class="keyword">await</span> http.<span class="keyword">get</span>(<span class="string">'https://jsonplaceholder.typicode.com/posts/1'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (response.statusCode == <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="comment">// If server returns an OK response, parse the JSON</span></span><br><span class="line">    <span class="keyword">return</span> Post.fromJson(json.decode(response.body));</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// If that response was not OK, throw an error.</span></span><br><span class="line">    <span class="keyword">throw</span> Exception(<span class="string">'Failed to load post'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="获取并显示数据"><a href="#获取并显示数据" class="headerlink" title="获取并显示数据"></a>获取并显示数据</h3><p>为了获取数据并将其显示在屏幕上，我们可以使用FutureBuilder小部件！该FutureBuilder控件带有Flutter可以很容易地与异步数据源的工作。</p>
<p>我们必须提供两个参数：</p>
<ol>
<li>在Future我们想要的工作。在我们的例子中，我们会调用我们的  fetchPost()函数。</li>
<li>一个builder函数，告诉Flutter渲染什么，取决于Future加载，成功或错误的状态。</li>
</ol>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">FutureBuilder&lt;Post&gt;(</span><br><span class="line">  future: fetchPost(),</span><br><span class="line">  builder: (context, snapshot) &#123;</span><br><span class="line">    <span class="keyword">if</span> (snapshot.hasData) &#123;</span><br><span class="line">      <span class="keyword">return</span> Text(snapshot.data.title);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (snapshot.hasError) &#123;</span><br><span class="line">      <span class="keyword">return</span> Text(<span class="string">"<span class="subst">$&#123;snapshot.error&#125;</span>"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// By default, show a loading spinner</span></span><br><span class="line">    <span class="keyword">return</span> CircularProgressIndicator();</span><br><span class="line">  &#125;,</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://wjwite.github.io/2018/06/28/Flutter获取互联网数据/Flutter/" data-id="cjizlkeq600033vj59oce778e" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/28/hello-world/example/" class="article-date">
  <time datetime="2018-06-28T03:07:46.000Z" itemprop="datePublished">2018-06-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/example/">example</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/28/hello-world/example/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://wjwite.github.io/2018/06/28/hello-world/example/" data-id="cjizlkema00003vj5aafes6sx" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Flutter/">Flutter</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/example/">example</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flutter/">Flutter</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Flutter/" style="font-size: 10px;">Flutter</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/06/28/Flutter新屏幕/Flutter/">Flutter新屏幕</a>
          </li>
        
          <li>
            <a href="/2018/06/28/Flutter获取互联网数据/Flutter/">Flutter 获取互联网数据</a>
          </li>
        
          <li>
            <a href="/2018/06/28/hello-world/example/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Wallace Wang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>